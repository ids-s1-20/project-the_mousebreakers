---
title: "Astronauts"
subtitle: "An investigation into the role that gender plays within the outer-space workplace!"
author: "The Mousebreakers <br> Bence Kaszás, Tom Gourlay, Sophie Jones, Julia Schönthaler & John Adibpour"
institute: "University of Edinburgh"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
editor_options: 
  chunk_output_type: console
---

```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(forcats)
library(dplyr)
library(knitr)
library(patchwork)
library(tidyr)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```

```{r load-data, include=FALSE}
astronauts_raw <- read_csv("/cloud/project/data/astronauts.csv")
```


```{r cleaning-data, echo = FALSE}
astronauts <- astronauts_raw %>% 
  mutate(
    occupation = case_when(
      occupation == "Commander" ~ "commander",
      occupation == "Flight engineer" ~ "flight engineer",
      occupation == "Pilot" ~ "pilot",
      occupation == "MSP" ~ "mission specialist",
      occupation == "PSP" ~ "payload specialist",
      occupation == "Other (space tourist)" ~ "space tourist",
      occupation == "Other (Space tourist)" ~ "space tourist",
      occupation == "Other (Journalist)" ~ "space tourist",
      occupation =="Space tourist" ~ "space tourist",
      occupation =="spaceflight participant" ~ "space tourist",
      TRUE ~ occupation)
  ) 

astronauts$occupation <- astronauts$occupation %>% 
  factor(levels = c("commander","pilot", "mission specialist", "flight engineer", "payload specialist", "space tourist"))

```

class: inverse, center, middle

# Introduction to the Dataset

---

# Introduction to the Dataset
The space industry is known for being male dominated, starting from before the first *man* on the moon, and continuing with current-day pioneers like Elon Musk. While this may be due to space-related occupations being primarily populated by STEM graduates, a notoriously gender-imbalanced field, we couldn't help but note the surprising lack of female representation in space when skimming through the "astronauts" dataset that we found in the TidyTuesday database, despite the recent push for women in STEM fields. Is there a deeper-rooted, systemic problem with gender in space? We intend to find out!
-  Any other things to say regarding statements of the overall goal / research
However, in recent years the proportion of males to females has begun to equalise. 


---

# Introduction to the Dataset
```{r echo = FALSE}

astronauts %>%
  ggplot(aes(x = year_of_selection, fill = sex)) + 
  geom_bar(position = "fill")+
  labs(title = "The proportion of male/female astronauts selected, by year",
       x = "Year of selection",
       y = "Percentage of male/female astronauts",
       caption = "Data from TidyTuesday's Astronaut Database")+
  theme(legend.title = element_blank())+
  scale_y_continuous(labels = scales::percent) 

```
---

# Women in space

.pull-left[
- The first woman in space was Valentina Tereshkova in 1963, the next being 19 years later! Both were from the Soviet Union.
- While a number of American women successfully underwent the astronaut selection process in the early 1960s, they were not eligible to be astronauts; all astronauts were required to be military test pilots, a career not available to women at the time.
- NASA opened the space program to female applicants in 1978, in response to new anti-discrimination laws. When Sally Ride became the first female U.S. astronaut to go into space, the media asked her questions about her reproductive organs and whether she would cry if things went wrong on the job. 
]

```{r First female astronaut, echo = FALSE, out.width = "25%", fig.align = "center", fig.cap = "Valentina Tereshkova, Copyright RSC Energia"}
include_graphics("https://anotherimg-dazedgroup.netdna-ssl.com/482/azure/another-prod/340/7/347259.jpg")
```
---

# Women in space


.pull-left[
- Material concerns may explain trends in EVA (spacewalk) time, for example; the low number of produced smaller sized space suits has been hindering women astronauts to do EVAs because of a lack of fitting suits.
- Due to the currently used risk models for endometrial, ovarian and breast cancer, women at NASA can currently only spend half as much time on missions as men, thereby limiting their career options compared to men, as both male and female astronauts are not allowed to accumulate a radiation dose that would increase their lifetime risk of developing fatal cancer by more than 3 percent. 
- NASA reports initially argued that menstruation could pose serious health risks or have a negative effect on performance, although it is now dealt with as a matter of routine.
]

```{r spacewalk, echo = FALSE, out.width = "40%", fig.align = "center", fig.cap = "Spacewalk, Copyright NASA"}

include_graphics("https://techcrunch.com/wp-content/uploads/2016/01/nasa-spacewalk.jpg?w=1390&crop=1")
  
```
---

```{r EVA grap, echo = FALSE, out.width = "100%"}
astronauts %>%
ggplot(aes(y = eva_hrs_mission, x = sex, fill = sex)) +
  geom_violin()+
  labs(title = "The difference in distribution of EVA times across males/females",
       x = "Sex",
       y = "EVA hours during mission")+
theme(legend.title = element_blank())
```

---

class: inverse, center, middle

# Comparing Gender with different variables

---
class: inverse, center, middle

# Country and Programme

---

# Gender selection by Country and Programme
As we began to explore the data, we wondered if certain progressive countries led the introduction of women into the profession, or if all countries started to do so at the same time.
- We found that:
- As shown by the data, the first female astronauts were introduced in the ____ missions, ....
- variable "selection" is programme
- *graph*
- Look into the programme in which the astronauts are enrolled in? What is the ratio of males to females in each programme? What country are these programmes held in? Is there a country in particular which is more/less progressive in gender equality?
Adjusted R Squared Value? Is adding sex beneficial?

---

#Nationality

.pull-left[
Nationality of those who have been to space:
```{r, echo = FALSE}
astronauts %>%
  group_by(nationality) %>%
  count() %>%
  arrange(desc(n))
  
```
]

.pull-right[
- Since 1959 people from 40 different nationalities have ventured into outer-space. 

- This includes countries you would expect such as the U.S. and Russia, as they are well known for their space programmes, but also lesser expectant countries such as Mongolia, Afghanistan and Saudi Arabia. 

- Overall, the U.S. has the highest contribution  of astronauts at 854 followed by the U.S.S.R/Russia at 273. 

- However, following this is a significant decrease with 20 Japanese nationals entering outer space and only 18 Canadians
 ]
 
.footnote[
[*] NOTE: Tibble is in decreasing order of Number of Astronauts from varying Nationalities.
]

---

#Nationality of Women in Space


```{r, echo = FALSE}
astronauts %>%
  filter(sex == "female") %>%
  mutate(nationality = fct_relevel(nationality, 
                           "U.S.",
                           "U.S.S.R/Russia", 
                           "Japan", 
                           "Canada",
                           "France", 
                           "China", 
                           "Italy", 
                           "Korea", 
                           "U.K.")) %>%
  mutate(nationality = fct_rev(nationality))  %>%
  group_by(nationality) %>%
  ggplot(aes(y = nationality, fill = nationality)) +
  theme(legend.position = "none") +
  geom_bar() +
  labs(title = "Nationality of Women in the Outer-Space Workplace", 
       y = "", 
       x = "Number of Women")
```

---

#Selection Programme of Women in Space

```{r, echo = FALSE}
astronauts_programme <- astronauts %>%
  filter(sex == "female") %>%
  mutate(selection = 
           case_when(
             selection == "NASA-8" ~ "NASA",
             selection == "NASA-9" ~ "NASA", 
             selection == "1978 NASA group" ~ "NASA",
             selection == "NASA- 10" ~ "NASA",
             selection == "1984 NASA group" ~ "NASA",
             selection == "NASA Astronaut Group 11" ~ "NASA",
             selection == "NASA Astronaut Group 12" ~ "NASA",
             selection == "NASA Astronaut Group 13" ~ "NASA",
             selection == "NASA Astronaut Group 14" ~ "NASA",
             selection == "NASA- 11" ~ "NASA",
             selection == "NASA- 12" ~ "NASA",
             selection == "NASA- 13" ~ "NASA",
             selection == "NASA- 14" ~ "NASA",
             selection == "NASA- 15" ~ "NASA",
             selection == "NASA PS" ~ "NASA",
             selection == "1990 NASA group" ~ "NASA",
             selection == "1992 NASA group" ~ "NASA",
             selection == "NASA- 16" ~ "NASA",
             selection == "NASA- 17" ~ "NASA",
             selection == "NASA- 18" ~ "NASA",
             selection == "NASA- 19" ~ "NASA",
             selection == "NASA- 8" ~ "NASA",
             selection == "NASA- 9" ~ "NASA",
             selection == "NASA-16" ~ "NASA",
             selection == "NASA-20" ~ "NASA",
             selection == "NASA-21" ~ "NASA",
             selection == "2004 NASA group" ~ "NASA",
             selection == "2000 NASA group" ~ "NASA",
             selection == "1998 NASA group" ~ "NASA",
             selection == "1996 NASA group" ~ "NASA",
             selection == "1992 NASA group" ~ "NASA",
             selection == "1963 NASA group 2" ~ "NASA",
             selection == "NASA-13" ~ "NASA",
             selection == "NASDA-1" ~ "NASDA", 
             selection == "NASDA-4" ~ "NASDA",
             selection == "NASDA-13" ~ "NASDA",
             TRUE ~ selection))
```

```{r, echo = FALSE}
astronauts_programme %>%
  mutate(selection = fct_relevel(selection, 
                                 "NASA", 
                                 "NASDA", 
                                 "NPOE-9", 
                                 "CNES-2/EAC", 
                                 "MAP",
                                 "1992 CSA Group"
                                 )) %>%
  ggplot(aes(y = selection, fill = selection)) +
  theme(legend.position = "none") +
  geom_bar() + 
  labs(x = "Number of Astronauts", 
       y = "", 
       title = "Selection Programme that Women Enrolled In")

```

---
#Selection Programme of Women in Space by Nationality 

```{r,echo = FALSE}
astronauts_programme %>%
  mutate(selection = fct_relevel(selection, 
                                 "NASA", 
                                 "NASDA", 
                                 "NPOE-9", 
                                 "CNES-2/EAC", 
                                 "MAP",
                                 "1992 CSA Group"
                                 )) %>%
  ggplot(aes(y = selection, fill = nationality)) +
  geom_bar() + 
  labs(x = "Number of Astronauts", 
       y = "", 
       title = "Selection Programme that Women Enrolled In",
       subtitle = "By Nationality", 
       fill = "Nationality")
```

---
class: inverse, center, middle

# Military Status and Occupation

---
# Gender and Military Status/Occupation
- A common indicator of workplace gender inequality is women having to outperform their male counterparts to receive the same level of treatment, pay or respect.
- Aware of this, we sought to investigate how military status affected selection for missions, and if female astronauts needed to occupy a higher military rank to be considered than males.
.pull-left[

We researched and rearranged the military ranks inside the occupation variable based on who was the highest ranking in each mission, and as shown at the table, it starts at the commander level and goes all the way down to space tourist.

]
.pull-right[
```{r occup_levels, echo = FALSE}
astronauts %>% 
  select(occupation) %>% 
  sapply(levels) %>% 
  kable(format = "html")
```
]


---
.pull-left[
- Analyse the role of sex in relationship to military status. Are females of Military Status more likely to become astronauts? Or are more civilian females enlisted?
Adjusted R Squared Value? Is adding sex beneficial?
- Investigation the effect of gender and occupation. What ranking do female astronauts hold? How has this changed? Are higher ranking females more likely to be enlisted as astronauts?
]
.pull-right[
```{r mil-civ,echo = FALSE, fig.width = 6}
p1 <- astronauts %>% 
  count(military_civilian) %>% 
  ggplot(aes(x = military_civilian, y = n, fill = military_civilian)) +
  geom_col() +
  labs(y = "Number of astronauts",
       x = NULL, 
       title = "All Astronauts")+
  theme(legend.position = "none")

p2 <- astronauts %>%
  filter(sex == "female") %>% 
  count(military_civilian) %>% 
  ggplot(aes(x = military_civilian, y = n, fill = military_civilian)) +
  geom_col() +
  labs(y = NULL,
       x = NULL, 
       title = "Female Astronauts")+
  theme(legend.position = "none")
  
p3 <- astronauts %>% 
  filter(sex == "male") %>% 
  count(military_civilian) %>% 
  ggplot(aes(x = military_civilian, y = n, fill = military_civilian)) +
  geom_col() +
  labs(y = NULL,
       x = NULL, 
       title = "Male Astronauts") +
  theme(legend.position = "none")
  
p1 + p2 + p3
```
]
.pull-right[
```{r mil-civ-time, echo = FALSE}
astronauts %>% 
  filter(sex == "female") %>%
  group_by(year_of_mission) %>% 
  mutate(n_mil = sum(military_civilian == "military"),
         n_civ = sum(military_civilian == "civilian")) %>% 
  select(n_mil, n_civ, year_of_mission) %>% 
  ggplot(aes(x = year_of_mission, y = n_civ)) +
  geom_smooth(se = FALSE) +
  geom_smooth(aes(x = year_of_mission, y = n_mil), color= "red", se = FALSE) +
  labs(y = "Number of Female Astronauts",
       x = "Year of the mission",
       title = "Number of Female Astronauts sent on Missions",
       subtitle = "by civilian status, over time")
  
```
]


---
class: inverse, center, middle

# Mission Stats

---
#Mission Hours

.pull-left[
```{r, echo = FALSE}
astronauts %>%
ggplot(aes(y = hours_mission, x = sex, fill = sex)) +
  geom_violin() +
  labs(x = "Gender", y = "Mission Hours")

astronauts %>%
    filter(hours_mission < 1000) %>%
ggplot(aes(y = hours_mission, x = sex, fill = sex)) +
  geom_violin() +
  labs(x = "Gender", y = "Mission Hours")


```
]

.pull-right[
- As shown by the graphs once a women is selected they aren't prejudiced in how long there mission are shown by the similarties in shape.

- This implies women are treated the same once employed and are are no more or less likely to get longer or shorter missions than men.

- However for missions over 7500 hours women are not selected, however missions of this length make up only `r sum(astronauts$hours_mission > 7500)` of 1227 missions so appears to be statistically insignificant.
]
---
#Recall for more missions
.pull-left[
```{r, echo = FALSE} 
astronauts %>%
ggplot(aes(x = total_number_of_missions, fill = sex)) +
  geom_bar(position = "fill")
```
]

.pull-right[
- While women are less likely to be selected for mission they are just as likely to be selected again for multiple mission once they have completed one.

- Also the probability of them being selected again as compared to men over more than 2 missions stays showing that they continue to do just as good job throughout all the missions they complete with no tail off.
]

.pull-center[
In conclusion  women are given the same mission hours and have the same likelihood to be recalled as men. This shows that while they are less likely to be selected in the first place they are treated the same once employed.
]

---

class: inverse, center, middle

# Conclusion

---

# ROC curve, predicting gender 

```{r, echo = FALSE}
f_astro <- mutate(astronauts, is_female = if_else(sex == "male", 0, 1))
```

```{r, echo = FALSE}
set.seed(1116)

astro_split <- initial_split(f_astro, prop = 0.80)

train_data <- training(astro_split)
test_data <- testing(astro_split)

gender_fit <- logistic_reg() %>%
  set_engine("glm") %>%
  fit(as.factor(is_female) ~ total_number_of_missions + occupation + year_of_selection + year_of_mission + eva_hrs_mission + hours_mission, data = train_data, family = "binomial")

gender_pred <- predict(gender_fit, test_data, type = "prob") %>%
  bind_cols(test_data %>% select(is_female))
```


```{r, echo=FALSE}
gender_pred %>%
  roc_curve (
    truth = as.factor(is_female),
    .pred_1,
    event_level = "second"
  ) %>%
  autoplot()
```

---
#Area under the ROC curve

```{r, echo=FALSE}
auc <- gender_pred %>%
  roc_auc (
    truth = as.factor(is_female),
    .pred_1,
    event_level = "second"
  )

auc 
```
--
- there is a relationship between covered variables and gender of the astronauts
--

- could be further explored and compared with different statistical models

---
# Conclusion

Upward trend in the number of women deployed in space missions. 
- changes in societal gender roles 
- striving for equality in the workplace


